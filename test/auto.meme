// Actors named Anna in films from 2012 to 2014
movies year >=2012;<=2014;title _;roles movie @;actor ~"Anna";;
movies year >=2012;<=2014;title _;roles movie @;actor ~"Anna";;

// Comedies in 1995 ranked by highest average role rating (top 3)
movies genre comedy;year 1995;title :grp;roles movie @;rating :avg:des;%m lim 3;;
movies genre comedy;year 1995;title :grp;roles movie @;rating :avg:des;%m lim 3;;

// Actors with 4 to 9 roles inclusive, alphabetical
roles actor :grp:asc;id :cnt>=4;:cnt<=9;;
roles id :cnt>=4;:cnt<=9;actor :grp:asc;;

// Movies released after 2000 whose title equals an actor name
movies year >2000;title _;actors name @;;
movies year >2000;title _;actors name @;;

// Actors aged 25 to 35 with average role rating at least 4.1
actors age >=25;<=35;name :grp;roles actor @;rating :avg>=4.1;;
actors age >=25;<=35;name :grp;roles actor @;rating :avg>=4.1;;

// Films from 2012 with "ocean" in description, titles Z-A
movies year 2012;description ~"ocean";title :des;_;;
movies year 2012;description ~"ocean";title :des;_;;

// Top 5 actors by minimum rating in robot-themed films
movies description <=>"robot"<=$sim;title _;roles movie @;actor :grp;rating :min:des;%m lim 5;;
movies description <=>"robot"<=$sim;title _;roles movie @;rating :min:des;actor :grp;%m lim 5;;

// Roles in Alien or Aliens where actor name equals the movie title
roles movie "Alien","Aliens";actor @;;
roles movie "Alien","Aliens";actor @;;

// Role counts per actor for documentaries in 2010, high to low
movies genre documentary;year 2010;title _;roles movie @;id :cnt:des;actor :grp;;
movies genre documentary;year 2010;title _;roles movie @;id :cnt:des;actor :grp;;

// Space exploration movies from 2000 and later: largest casts first, top 10
movies year >=2000;description <=>"space exploration"<=$sim;title :grp;roles movie @;id :cnt:des;%m lim 10;;
movies year >=2000;description <=>"space exploration"<=$sim;title :grp;roles movie @;id :cnt:des;%m lim 10;;

// Dramas from 1980 to 1989 ordered by title A-Z
movies year >=1980;<=1989;genre drama;title :asc;_;;
movies genre drama;year >=1980;<=1989;title :asc;_;;

// Actors with most roles in 1999, top 7
movies year 1999;title _;roles movie @;actor :grp;id :cnt:des;%m lim 7;;
movies year 1999;title _;roles movie @;id :cnt:des;actor :grp;%m lim 7;;

// Average role rating per movie in 2001, high to low
movies year 2001;title :grp;roles movie @;rating :avg:des;;
movies year 2001;title :grp;roles movie @;rating :avg:des;;

// Actors with "Lee" in name sorted by youngest first
actors name ~"Lee";age :asc;_;;
actors name ~"Lee";age :asc;_;;

// Movie titles equal to an actor name in 1985
movies year 1985;title _;actors name @;_;;
movies year 1985;title :$x;actors name $x;;

// Space-themed films in 2016 ranked by max role rating, top 5
movies year 2016;description <=>"space"<=$sim;title :grp;roles movie @;rating :max:des;%m lim 5;;
movies year 2016;description <=>"space exploration"<=$sim;title :grp;roles movie @;rating :max:des;%m lim 5;;

// Actors aged 30 to 50 with average role rating at least 4.5
roles actor :grp;actors name @;age >=30;<=50;rating :avg>=4.5;;
actors age >=30;<=50;name :grp;roles actor @;rating :avg>=4.5;;

// 1977 releases most similar to "rebellion", similarity high to low
movies year 1977;description <=>"rebellion":des;_;;
movies year 1977;description <=>"rebellion":des;title _;;

// Roles where actor includes "Smith" in 2003 movies
movies year 2003;title _;roles movie @;actor ~"Smith";_;;
movies year 2003;title _;roles movie @;actor ~"Smith";_;;

// Role counts per movie in 1994, lowest to highest
movies year 1994;title :grp;roles movie @;id :cnt:asc;;
movies year 1994;title :grp;roles movie @;id :cnt:asc;;

// Sci-fi releases from 1980 through 1999 mentioning robot or android; list co-stars of people named like Mark with strictly higher role ratings (A-Z), cap 12
movies genre scifi;year >=1980;<=1999;description ~"robot","android";title _;roles movie @;actor :$a~"Mark";rating :$r=_;movie _;@ @ @;actor :asc=!$a;rating >$r;%m lim 12;;
movies genre scifi;year >=1980;<=1999;description ~"robot","android";title _;roles movie @;actor :$x~"Mark";rating :$y;movie _;@ @ @;actor !=$x;rating >$y;%m lim 12;;

// Films from 2000 and later with the strongest average role ratings and largest casts, show by movie (both metrics descending, top 10)
movies year >=2000;title :grp;roles movie @;rating :avg:des;id :cnt:des;%m lim 10;;
movies year >=2000;title :grp;roles movie @;rating :avg:des;id :cnt:des;%m lim 10;;

// Actors whose name includes Ann and age between 25 and 60 appearing in politically intriguing films, most relevant first
actors name ~"Ann";age >=25;<=60;roles actor @;movie _;movies title @;description <=>"political intrigue":des;_;;
movies description <=>"politically intriguing":des;title _;roles movie @;actor ~"Ann";actors name @;age >=25;<=60;;

// Movies after 1995 where casts are mid-sized (5–12) and average role rating is at least 3.5; break ties by max rating desc then title asc
movies year >1995;title :grp;roles movie @;id :cnt>=5;:cnt<=12;rating :avg>=3.5;:max:des;movie :asc;;
movies year >1995;title :grp;roles movie @;id :cnt>=5;:cnt<=12;rating :avg>=3.5;:max:des;;

// Drama titles since 2000 about artificial intelligence, newest releases first, page 3 with 30 per page
movies genre drama;year :des>=2000;description <=>"artificial intelligence"<=$sim;_;%m lim 30;beg 60;;
movies genre drama;year :des>=2000;description ~"artificial intelligence";title _;%m lim 30;beg 60;;

// Youngest five co-stars who appeared with Harrison Ford in films released before 1990
roles actor :$a~"Harrison Ford";movie _;movies title @;year <1990;title _;roles movie @;actor !$a;actors name @;age :asc;%m lim 5;;
movies year <1990;title _;roles movie @;actor :$x~"Harrison Ford";movie _;@ @ @;actor !=$x;actors name @;age :asc;%m lim 5;;

// People whose name exactly matches a movie title and whose roles from 2010 to 2015 average at least 3, ordered by that average descending
actors name :$x:grp;movies title $x;roles actor $x;rating :avg:des>=3;movie _;movies title @;year >=2010;<=2015;;
actors name :$x:grp;movies title $x;roles actor $x;rating :avg:des>=3;movie _;movies title @;year >=2010;<=2015;;

// Space exploration films from 1960–1975 ranked by cast size, tie-break by highest role rating then title A-Z (top 10)
movies description <=>"space exploration"<=$sim;year >=1960;<=1975;title :grp;roles movie @;id :cnt:des;rating :max:des;movie :asc;%m lim 10;;
movies description <=>"space exploration"<=$sim;year >=1960;<=1975;title :grp;roles movie @;id :cnt:des;rating :max;title :asc;%m lim 10;;

// Comedies after 2000 where a role rating is at least 3.5 performed by actors under 18; list movie titles with actor names
movies genre comedy;year >2000;title _;roles movie @;rating >=3.5;actor _;actors name @;age <18;_;;
movies genre comedy;year >2000;title _;roles movie @;rating >=3.5;actor _;actors name @;age <18;;

// Year buckets after 1977 for space opera movies, ascending by year with film counts
movies description <=>"space opera"<=$sim;year :grp:asc>1977;id :cnt;;
movies description <=>"space opera"<=$sim;id :cnt;year :grp:asc>1977;;

// Active full-time hires in 2024 with department name and country
employees status active;full_time 1;hire_date >=2024-01-01;<=2024-12-31;department_id _;departments id @;name _;location_id _;locations id @;country _;;
employees hire_date >=2024-01-01;<=2024-12-31;status active;full_time 1;department_id _;departments id @;name _;location_id _;locations id @;country _;;

// Managers with at least 5 direct reports, names included, sorted by headcount
employees manager_id :grp;id :cnt:des>=5;employees id @;first_name _;last_name _;;
employees id :cnt:des>=5;manager_id :grp;employees id @;first_name _;last_name _;;

// Top 12 net pay results in payroll run 2002 with employee names
payroll_runs id 2002;id _;payroll_entries payroll_run_id @;net_pay :des;employee_id _;employees id @;_;%m lim 12;;
payroll_entries payroll_run_id 2002;net_pay :des;employee_id _;employees id @;first_name _;last_name _;%m lim 12;;

// Reviews since 2024-01-01 most similar to mentorship with rating 4 or higher
performance_reviews review_date >=2024-01-01;rating >=4;comments <=>"mentorship":des;_;;
performance_reviews review_date >=2024-01-01;comments <=>"mentorship":des;rating >=4;_;;

// Comments close to collaboration with similarity >= 0.6 between 2023-01-01 and 2025-12-31
performance_reviews comments <=>"collaboration"<=0.6;review_date >=2023-01-01;<=2025-12-31;_;;
performance_reviews comments <=>"collaboration"<=0.6;review_date >=2023-01-01;<=2025-12-31;_;;

// Employees under manager 5 with first and last names
employees manager_id 5;first_name _;last_name _;;
employees manager_id 5;first_name _;last_name _;;

// USD payroll entries in June 2025 with department name for employees paid at least 2500
payroll_entries currency "USD";created >=2025-06-01;<=2025-06-30;net_pay >=2500;employee_id _;employees id @;department_id _;departments id @;name _;;
payroll_entries currency "USD";created >=2025-06-01;<=2025-06-30;net_pay >=2500;employee_id _;employees id @;department_id _;departments id @;name _;;

// Job grades where avg min_salary >= 70000 ordered by average descending
jobs grade :grp;min_salary :avg:des>=70000;;
jobs min_salary :avg:des>=70000;grade :grp;;

// Employees in departments located in US-NY ordered by hire_date desc, page 2 of 20
locations country "US";region "NY";id _;departments location_id @;id _;employees department_id @;hire_date :des;_;%m lim 20;beg 20;;
locations country "US";region "NY";id _;departments location_id @;id _;employees department_id @;hire_date :des;_;%m lim 20;beg 20;;

// Employees with expert Data skills last used in 2024, sort last name A-Z
skills category "Data";id _;employee_skills skill_id @;level expert;last_used >=2024-01-01;<=2024-12-31;employee_id _;employees id @;last_name :asc;;
skills category "Data";id _;employee_skills skill_id @;level expert;last_used >=2024-01-01;<=2024-12-31;employee_id _;employees id @;last_name :asc;first_name _;;

// Average hours worked per employee for submitted timesheets in February 2025 with last names
timesheets submitted 1;week_start >=2025-02-01;<=2025-02-28;employee_id :grp;hours_worked :avg;employees id @;last_name _;;
timesheets submitted 1;week_start >=2025-02-01;<=2025-02-28;hours_worked :avg;employee_id :grp;employees id @;first_name _;last_name _;;

// USD payroll net pay totals per employee in July 2025 with last name A-Z where sum >= 3000
payroll_entries currency "USD";employee_id :grp;net_pay :sum>=3000;payroll_run_id _;payroll_runs id @;pay_date >=2025-07-01;<=2025-07-31;employees id @;last_name :asc;;
payroll_runs pay_date >=2025-07-01;<=2025-07-31;id _;payroll_entries payroll_run_id @;currency "USD";net_pay :sum>=3000;employee_id :grp;employees id @;last_name :asc;first_name _;;

// Department headcount for locations in US-CA with department name, count desc
employees id :cnt:des;department_id :grp;departments id @;name _;location_id _;locations id @;country "US";region "CA";;
locations country "US";region "CA";id _;departments location_id @;name _;id :grp;employees department_id @;id :cnt:des;;

// Denied or canceled time off in 2025-09 with employee names, sorted by start date
time_off_requests status denied,canceled;start_date :asc>=2025-09-01;<=2025-09-30;employee_id _;employees id @;first_name _;last_name _;_;;
time_off_requests status denied,canceled;start_date :asc>=2025-09-01;<=2025-09-30;employee_id _;employees id @;first_name _;last_name _;;

// Approver names for timesheets with overtime > 5 during 2025-06, week_start desc
timesheets overtime_hours >5;week_start :des>=2025-06-01;<=2025-06-30;approver_id _;employees id @;last_name _;first_name _;;
timesheets overtime_hours >5;week_start :des>=2025-06-01;<=2025-06-30;approver_id _;employees id @;first_name _;last_name _;;

// Latest week_start per employee for submitted timesheets with employee last name
timesheets submitted 1;employee_id :grp;week_start :last;employees id @;last_name _;;
timesheets submitted 1;week_start :max;employee_id :grp;employees id @;first_name _;last_name _;;

// Non-terminated employees with salary 60000..150000, order by salary desc then hire_date asc, limit 50 offset 50
employees status !=terminated;salary :des>=60000;<=150000;hire_date :asc;_;%m lim 50;beg 50;;
employees status !=terminated;salary :des>=60000;<=150000;hire_date :asc;_;%m lim 50;beg 50;;

// Approved parental leave in Q1 2025 with hours >= 40 and employee names, hours desc
time_off_requests type parental;status approved;start_date >=2025-01-01;<=2025-03-31;hours :des>=40;employee_id _;employees id @;first_name _;last_name _;;
time_off_requests type parental;status approved;start_date >=2025-01-01;<=2025-03-31;hours :des>=40;employee_id _;employees id @;first_name _;last_name _;;

// Medical benefit plans with enrollment counts sorted high to low, show plan name
employee_benefits id :cnt:des;benefit_plan_id :grp;benefit_plans id @;type medical;name _;;
employee_benefits id :cnt:des;benefit_plan_id :grp;benefit_plans id @;type medical;name _;;

// Gross pay totals per payroll run during 2025-06, sort by total desc with pay_date
payroll_entries gross_pay :sum:des;payroll_run_id :grp;payroll_runs id @;pay_date >=2025-06-01;<=2025-06-30;;
payroll_entries gross_pay :sum:des;payroll_run_id :grp;payroll_runs id @;pay_date >=2025-06-01;<=2025-06-30;;

